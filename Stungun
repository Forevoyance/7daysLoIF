<!-- * * * * * * * * * * Custom Guns (perkWhoKnows?) * * * * * * * * * * -->

<item name="gunStungunT1">
	<property name="Tags" value="weapon,ranged,holdBreathAiming,reloadPenalty,gun,shortRange,pistol,barrelAttachments,sideAttachments,smallTopAttachments,magazine,firingMode,attAgility,perkGunslinger,9mmGun,canHaveCosmetic"/>
	<property name="DisplayType" value="rangedGun"/>
	<property name="HoldType" value="1"/>
	<property name="Meshfile" value="#Other/Items?Weapons/Ranged/Pistol/PistolPrefab.prefab"/>
	<property name="Material" value="MHandGunParts"/> <property name="Weight" value="4"/>
	<property name="RepairTools" value="resourceRepairKit"/>
	<property name="DegradationBreaksAfter" value="false"/>
	<property name="SoundJammed" value="weapon_jam"/>
	<property name="Attachments" value="meleeToolFlashlight02"/>
	<property name="CrosshairOnAim" value="true"/> <!-- aimTest -->
	<property name="CrosshairUpAfterShot" value="true"/> <!-- aimTest -->
	<property name="Sound_Sight_In" value="pistol_sight_in"/>
	<property name="Sound_Sight_Out" value="pistol_sight_out"/>
	<property name="LightSource" value="lightSource"/> <!-- Start: Needed for the attachment flashlight -->
	<property name="ActivateObject" value="Attachments/flashlight/lightSource"/>
	<property name="AttachmentFlashlight" value="flashlight02"/> <!-- End: Needed for the attachment flashlight -->
	<property name="Group" value="Ammo/Weapons"/>
	<property name="RepairExpMultiplier" value="10.8"/>
	<property name="LightValue" value=".45"/>
	<property name="EconomicValue" value="500"/>
	<property name="UnlockedBy" value="perkGunslinger,gunHandgunT1PistolSchematic"/>
	<property name="ShowQuality" value="true"/>

	<property class="Action0">
		<property name="Class" value="Ranged"/>
		<property name="Magazine_items" value="ammo9mmBulletBall,ammo9mmBulletHP,ammo9mmBulletAP"/>
		<property name="Sound_start" value="Pistol_Fire"/>
		<property name="Sound_loop" value="Pistol_Fire"/>
		<property name="Sound_end" value=""/>
		<property name="Sound_empty" value="dryfire"/>
		<property name="Sound_reload" value="pistol_reload"/>
		<property name="Particles_muzzle_fire" value="gunfire_pistol"/>
		<property name="Particles_muzzle_fire_fpv" value="gunfire_pistol_fpv"/>
		<requirement name="CVarCompare" cvar="_underwater" operation="LT" value=".98"/>
	</property>
	<property class="Action1">
		<property name="Class" value="Zoom"/>
		<property name="Zoom_max_out" value="55"/>
		<property name="Zoom_max_in" value="55"/>
		<property name="ScopeCameraOffset" value="0,.0008,0"/>
	</property>

	<effect_group name="gunStunGun">
		<passive_effect name="MaxRange" operation="base_set" value="50" tags="perkGunslinger,9mmGun"/>
		<passive_effect name="DamageFalloffRange" operation="base_set" value="18" tags="perkGunslinger,9mmGun"/>
		<passive_effect name="DamageFalloffRange" operation="perc_add" value="-.2,.2" tags="perkGunslinger,9mmGun"/> <!-- random effective rng -->

		<passive_effect name="RoundsPerMinute" operation="base_set" value="420" tags="perkGunslinger"/>
		<passive_effect name="BurstRoundCount" operation="base_set" value="2" tags="perkGunslinger"/>

		<passive_effect name="MagazineSize" operation="base_set" value="2" tags="perkGunslinger"/>
		<passive_effect name="ReloadSpeedMultiplier" operation="base_set" value="1" tags="perkGunslinger"/> <!-- 2s -->
		<passive_effect name="ModSlots" operation="base_set" value="1,1,2,2,3,4,5,6" tier="1,2,3,4,5,6,7,8"/>
		<passive_effect name="ModPowerBonus" operation="perc_add" value=".10" tags="EntityDamage,BlockDamage"/>
		<passive_effect name="ModPowerBonus" operation="base_add" value="300" tags="EconomicValue"/>

		<passive_effect name="EntityDamage" operation="perc_add" value="0,.0" tags="perkGunslinger"/> <!-- random EntityDmg -->
		<passive_effect name="EntityDamage" operation="perc_add" value=".1,.8" tier="2,8" tags="perkGunslinger"/> <!-- tier bonus -->
		<passive_effect name="BlockDamage" operation="perc_add" value="0,0" tags="perkGunslinger"/> <!-- random BlockDmg -->
		<passive_effect name="BlockDamage" operation="perc_add" value=".1,.8" tier="2,8" tags="perkGunslinger"/> <!-- tier bonus -->

		<passive_effect name="DegradationMax" operation="perc_add" value="-.2,.2" tags="perkGunslinger"/> <!-- random DegMax -->
		<passive_effect name="RoundsPerMinute" operation="perc_add" value="-.05,.05" tags="perkGunslinger"/> <!-- random APM -->
		<passive_effect name="MagazineSize" operation="perc_add" value="-.122,.122"/> <!-- random MagazineSize -->
		<passive_effect name="WeaponHandling" operation="perc_add" value="-.08,.08" tags="perkGunslinger"/> <!-- random WeaponHandling -->

		<passive_effect name="SpreadDegreesVertical" operation="base_set" value="1.5" tags="perkGunslinger"/>
		<passive_effect name="SpreadDegreesHorizontal" operation="base_set" value="1.5" tags="perkGunslinger"/>
		<passive_effect name="SpreadMultiplierAiming" operation="base_set" value=".4" tags="perkGunslinger"/>
		<passive_effect name="SpreadMultiplierCrouching" operation="base_set" value=".8" tags="perkGunslinger"/>
		<passive_effect name="SpreadMultiplierWalking" operation="base_set" value="1.5" tags="perkGunslinger"/>
		<passive_effect name="SpreadMultiplierRunning" operation="base_set" value="2.2" tags="perkGunslinger"/>
S
		<passive_effect name="KickDegreesVerticalMin" operation="base_set" value=".7" tags="perkGunslinger"/>
		<passive_effect name="KickDegreesVerticalMax" operation="base_set" value=".8" tags="perkGunslinger"/>
		<passive_effect name="KickDegreesHorizontalMin" operation="base_set" value="-.25" tags="perkGunslinger"/>
		<passive_effect name="KickDegreesHorizontalMax" operation="base_set" value=".25" tags="perkGunslinger"/>

		<passive_effect name="IncrementalSpreadMultiplier" operation="base_set" value="2.0" tags="perkGunslinger,9mmGun"/>
		<passive_effect name="WeaponHandling" operation="base_set" value=".95" tags="perkGunslinger"/> <!-- crosshair reset speed -->

		<passive_effect name="DegradationMax" operation="base_set" value="250,516" tier="1,8" tags="perkGunslinger,9mmGun"/>
		<passive_effect name="DegradationPerUse" operation="base_set" value="1" tags="perkGunslinger,9mmGun"/>
	</effect_group>

	<effect_group name="apply damage buff, meleeWpnBatonT3PlasmaBaton">
		<requirement name="CVarCompare" cvar="stunBatonCharge" operation="GTE" value="40"/>
			<triggered_effect trigger="onSelfEquipStart" action="AddPart" part="Sparks" prefab="ItemModEffects/baton_electricityPrefab" parentTransform="Handle" localPos="0,.071,-.35" localRot="90,0,0"/>

			<triggered_effect trigger="onSelfPrimaryActionRayHit" action="AddBuff" target="other" buff="buffShocked"/>
			<triggered_effect trigger="onSelfSecondaryActionRayHit" action="AddBuff" target="other" buff="buffShocked"/>

			<triggered_effect trigger="onSelfPrimaryActionRayHit" action="AddBuff" target="otherAOE" range="1.1" target_tags="zombie,animal" buff="buffShocked">
				<requirement name="HasBuff" buff="buffDrugNerdTats"/>
			</triggered_effect>

			<triggered_effect trigger="onSelfPrimaryActionRayHit" action="RemovePart" part="Sparks"/>

			<triggered_effect trigger="onSelfPrimaryActionRayHit" action="ModifyCVar" cvar="stunBatonCharge" operation="set" value="0"/>
			<triggered_effect trigger="onSelfSecondaryActionRayHit" action="ModifyCVar" cvar="stunBatonCharge" operation="set" value="0"/>
	</effect_group>

<!--
needed?
			<requirement name="ItemHasTags" tags="perkElectrocutioner"/>

			<requirement name="EntityTagCompare" target="other" tags="human,zombie,animal"/>
-->

	<effect_group name="increase charges">
		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="ModifyCVar" cvar="stunBatonCharge" operation="add" value="1">
			<requirement name="IsAlive" target="other"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfSecondaryActionRayHit" action="ModifyCVar" cvar="stunBatonCharge" operation="add" value="2">
			<requirement name="IsAlive" target="other"/>
		</triggered_effect>

		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="ModifyCVar" cvar="stunBatonCharge" operation="add" value="1">
			<requirement name="ProgressionLevel" progression_name="perkTechJunkie6BatonCharge" operation="Equals" value="1"/>
			<requirement name="IsAlive" target="other"/>
			<requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="25"/>
		</triggered_effect>

		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="AddPart" part="Sparks" prefab="ParticleEffects/p_electric_shock_small" parentTransform="Handle" localPos="0,.071,-.35" localRot="90,0,0">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="GTE" value="2"/>
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="LT" value="40"/>
		</triggered_effect>
		
		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="AddPart" part="Sparks" prefab="ParticleEffects/p_electric_shock_small" parentTransform="Handle" localPos="0,.1,-.35" localRot="90,0,0">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="GTE" value="2"/>
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="LT" value="40"/>
		</triggered_effect>

		<!-- the attack that applies the last +1 charge can not immediately trigger the effect -->
		<triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="stunBatonCharge" operation="set" value="40">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="GTE" value="2"/>
		</triggered_effect>

		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="PlaySound" sound="stunbaton_hit1">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="Equals" value="1"/></triggered_effect>
		<triggered_effect trigger="onSelfPrimaryActionRayHit" action="PlaySound" sound="stunbaton_hit5">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="GTE" value="2"/></triggered_effect>

		<!--<triggered_effect trigger="onSelfAttackedOther" action="PlaySound" sound="stunbaton_hit5">
			<requirement name="CVarCompare" cvar="stunBatonCharge" operation="Equals" value="1"/>
		</triggered_effect>-->
	</effect_group>

</item>
